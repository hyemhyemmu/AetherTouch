# AetherTouch 模型训练参数

本文档记录了用于训练 AetherTouch 手势和元器件识别模型的所有参数设置。

## 基本训练参数

| 参数       | 值                      | 说明                       |
| ---------- | ----------------------- | -------------------------- |
| 模型架构   | YOLOv5s                 | 平衡速度和精度的中小型模型 |
| 输入尺寸   | 640×640                 | 标准 YOLOv5 输入尺寸       |
| 批处理大小 | 16                      | 每批处理 16 张图像         |
| 训练轮数   | 100                     | 总训练轮数                 |
| 早停机制   | 30                      | 30 轮无改善自动停止        |
| 保存频率   | 1                       | 每轮保存一次权重           |
| 缓存策略   | 启用                    | 使用内存缓存加速训练       |
| 数据集分割 | 70%训练/15%验证/15%测试 | 标准数据集分割比例         |

## 优化器设置

| 参数           | 值     | 说明                           |
| -------------- | ------ | ------------------------------ |
| 优化器         | SGD    | 随机梯度下降优化器             |
| 初始学习率     | 0.01   | 训练开始的学习率               |
| 最终学习率因子 | 0.1    | 最终学习率 = 初始学习率 × 因子 |
| 动量           | 0.937  | SGD 优化器的动量参数           |
| 权重衰减       | 0.0005 | L2 正则化系数                  |
| 预热轮数       | 3.0    | 学习率预热的轮数               |
| 预热动量       | 0.8    | 预热阶段的动量                 |

## 损失函数权重

| 参数             | 值   | 说明                       |
| ---------------- | ---- | -------------------------- |
| 边界框损失权重   | 0.05 | 控制边界框位置精度的重要性 |
| 类别损失权重     | 0.3  | 控制类别分类准确性的重要性 |
| 目标存在损失权重 | 0.7  | 控制目标检测置信度的重要性 |
| IoU 阈值         | 0.2  | 边界框匹配的交并比阈值     |

## 数据增强参数

| 参数         | 值    | 说明                      |
| ------------ | ----- | ------------------------- |
| 色调增强     | 0.015 | HSV 色调变化范围(±)       |
| 饱和度增强   | 0.7   | HSV 饱和度变化范围(±)     |
| 亮度增强     | 0.4   | HSV 亮度变化范围(±)       |
| 旋转角度     | 0.0   | 旋转增强角度(± 度)        |
| 平移         | 0.1   | 图像平移范围(± 比例)      |
| 缩放         | 0.9   | 图像缩放范围(± 比例)      |
| 剪切         | 0.0   | 图像剪切变换范围(± 度)    |
| 透视变换     | 0.0   | 透视变换强度              |
| 上下翻转概率 | 0.0   | 图像上下翻转概率          |
| 左右翻转概率 | 0.5   | 图像左右翻转概率          |
| 马赛克增强   | 1.0   | 使用马赛克数据增强的概率  |
| 混合增强     | 0.1   | 使用 mixup 数据增强的概率 |

## 推理参数

| 参数       | 值   | 说明                     |
| ---------- | ---- | ------------------------ |
| 置信度阈值 | 0.25 | 检测结果的最小置信度     |
| IoU 阈值   | 0.45 | 非极大值抑制的 IoU 阈值  |
| 最大检测数 | 300  | 每张图像的最大检测框数量 |

## 导出设置

| 参数      | 值   | 说明                     |
| --------- | ---- | ------------------------ |
| 导出格式  | ONNX | 跨平台模型格式           |
| ONNX 简化 | 是   | 简化 ONNX 模型以提高性能 |
| 批量大小  | 1    | 推理批量大小             |
| 半精度    | 否   | 使用 FP32 精度           |

## 数据集统计

| 类别        | 图像数量 |
| ----------- | -------- |
| GPIO LED    | ~300     |
| buzzer      | ~300     |
| fist        | ~300     |
| open_palm   | ~300     |
| pinch       | ~300     |
| pointing    | ~300     |
| two_fingers | ~300     |
| **总计**    | ~2100    |

## 硬件环境

- **训练平台**: Google Colab
- **GPU**: Tesla T4
- **内存**: 12GB
- **CUDA 版本**: 12.4
- **PyTorch 版本**: 2.6.0

## 模型结构

- **层数**: 157 层
- **参数数量**: 7,029,004
- **计算复杂度**: 15.8 GFLOPs

## 性能指标

### 验证集性能

| 类别        | 精确率(P) | 召回率(R) | mAP@0.5 | mAP@0.5:0.95 |
| ----------- | --------- | --------- | ------- | ------------ |
| 全部类别    | 0.783     | 0.920     | 0.868   | 0.685        |
| GPIO LED    | 0.892     | 0.875     | 0.890   | 0.746        |
| buzzer      | 0.952     | 0.988     | 0.988   | 0.641        |
| fist        | 0.685     | 0.923     | 0.860   | 0.789        |
| open_palm   | 0.865     | 1.000     | 0.982   | 0.865        |
| pinch       | 0.826     | 0.882     | 0.840   | 0.478        |
| pointing    | 0.763     | 0.969     | 0.864   | 0.718        |
| two_fingers | 0.499     | 0.800     | 0.649   | 0.559        |

### 备选模型性能（30 轮检查点）

| 类别        | 精确率(P) | 召回率(R) | mAP@0.5 | mAP@0.5:0.95 |
| ----------- | --------- | --------- | ------- | ------------ |
| 全部类别    | 0.805     | 0.834     | 0.878   | 0.681        |
| GPIO LED    | 0.766     | 0.875     | 0.881   | 0.710        |
| buzzer      | 0.989     | 0.900     | 0.959   | 0.659        |
| fist        | 0.650     | 0.846     | 0.884   | 0.810        |
| open_palm   | 0.892     | 0.975     | 0.960   | 0.863        |
| pinch       | 0.903     | 0.765     | 0.918   | 0.468        |
| pointing    | 0.795     | 0.775     | 0.929   | 0.735        |
| two_fingers | 0.637     | 0.700     | 0.617   | 0.521        |

### 模型选择说明

所选模型（当前结果）优势：

- 整体召回率更高（0.920 vs 0.834）
- buzzer 类别识别更准确（mAP@0.5: 0.988 vs 0.959）
- open_palm 类别召回率达到 100%
- pointing 类别召回率明显更高（0.969 vs 0.775）
- two_fingers 类别召回率更高（0.800 vs 0.700）

备选模型（30 轮检查点）优势：

- 整体mAP@0.5略高（0.878 vs 0.868）
- 整体精确率更高（0.805 vs 0.783）
- pinch 类别mAP@0.5显著更高（0.918 vs 0.840）
- pointing 类别mAP@0.5更高（0.929 vs 0.864）

### 推理速度

- **预处理**: 0.9ms/图像
- **推理**: 11.3ms/图像
- **NMS 后处理**: 3.2ms/图像
- **总推理时间**: ~15.4ms/图像 (约 65FPS@640×640)
- **推理设备**: Tesla T4 GPU
